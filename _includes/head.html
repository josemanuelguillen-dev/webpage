<meta charset="utf-8">

{% include seo.html %}

{% unless site.atom_feed.hide %}
  <link href="{% if site.atom_feed.path %}{{ site.atom_feed.path }}{% else %}{{ '/feed.xml' | relative_url }}{% endif %}" type="application/atom+xml" rel="alternate" title="{{ site.title }} Feed">
{% endunless %}

{%- comment %} https://docs.google.com/presentation/d/1rmxwWa9P6_xHqonmh5ONXRS-jPc5XKbnv99Rjkhe04s/present {% endcomment -%}
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- TIPOGRAFÍA VARIABLE RECOMENDACIÓN KIMI PARA ELEGANCIA -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<!-- GSAP INICIO de la prueba  -->
<!-- GSAP Scroll Suave + Animaciones -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollToPlugin.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@studio-freight/lenis@1.0.23/bundled/lenis.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // 1. Inicializar Lenis (scroll suave)
  const lenis = new Lenis({
    duration: 1.2,        // Duración del scroll suave (en segundos)
    easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)), // Easing natural
    orientation: 'vertical',
    smoothWheel: true,
    smoothTouch: false,   // Desactivar en móvil para mejor performance
  });

  // 2. Sincronizar Lenis con GSAP
  function raf(time) {
    lenis.raf(time);
    requestAnimationFrame(raf);
  }
  requestAnimationFrame(raf);

  // 3. Vincular ScrollTrigger con Lenis
  ScrollTrigger.scrollerProxy(document.body, {
    scrollTop(value) {
      if (arguments.length) {
        lenis.scrollTo(value, {immediate: true});
      }
      return lenis.scroll;
    },
    getBoundingClientRect() {
      return {top: 0, left: 0, width: window.innerWidth, height: window.innerHeight};
    }
  });

  lenis.on('scroll', ScrollTrigger.update);

  // 4. Registrar plugins
  gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

  // 5. Animación universal para .animate-on-scroll
  gsap.utils.toArray(".animate-on-scroll").forEach(el => {
    gsap.from(el, {
      opacity: 0,
      y: 40,
      duration: 0.8,
      scrollTrigger: {
        trigger: el,
        start: "top 85%",
        toggleActions: "play none none reverse",
        scroller: document.body  // IMPORTANTE: usar body como scroller
      }
    });
  });

  // 6. Animación para imágenes .animar-imagen
  gsap.utils.toArray(".animar-imagen").forEach(img => {
    const loadHandler = () => {
      gsap.fromTo(img, 
        {opacity: 0, scale: 0.9, y: 30},
        {
          opacity: 1, 
          scale: 1, 
          y: 0,
          duration: 1,
          scrollTrigger: {
            trigger: img,
            start: "top 85%",
            toggleActions: "play none none reverse",
            scroller: document.body
          }
        }
      );
      
      // Hover elegante
      img.addEventListener('mouseenter', () => {
        gsap.to(img, {scale: 1.05, duration: 0.3, ease: "power2.out"});
      });
      img.addEventListener('mouseleave', () => {
        gsap.to(img, {scale: 1, duration: 0.3, ease: "power2.out"});
      });
    };
    
    img.complete ? loadHandler() : img.addEventListener('load', loadHandler);
  });

  // 7. Scroll suave para enlaces internos
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', (e) => {
      const target = document.querySelector(anchor.getAttribute('href'));
      if (target) {
        e.preventDefault();
        lenis.scrollTo(target);
      }
    });
  });
});
</script>
<!-- GSAP FIN de la prueba  -->

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  {% if site.enable_copy_code_button -%}
    window.enable_copy_code_button = true;
  {%- endif %}
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="{{ './assets/css/main.css' | relative_url }}">
<link rel="stylesheet" href="{{ './assets/css/fps.css' | relative_url }}">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>

{% if site.head_scripts %}
  {% for script in site.head_scripts %}
    <script src="{{ script | relative_url }}"></script>
  {% endfor %}
	{% include search_form.html %}
{% endif %}
